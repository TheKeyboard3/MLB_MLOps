–ó–∞–ø–∏—Ç:
–ö–æ–Ω—Ç–µ–∫—Å—Ç: —è —Å—Ç—É–¥–µ–Ω—Ç, –≤–∏–∫–æ–Ω—É—é –ø—Ä–∞–∫—Ç–∏—á–Ω—É —Ä–æ–±–æ—Ç—É –∑ MLOps —É Jupyter –Ω–∞ Python 3.12.12, –û–° Linux, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç AutoML - H2O AutoML
–î–∞–Ω—ñ: —Ç–∏–ø –∑–∞–¥–∞—á—ñ: –±—ñ–Ω–∞—Ä–Ω–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è, CSV ~600 —Ä—è–¥–∫—ñ–≤, 30 –æ–∑–Ω–∞–∫, —Ü—ñ–ª—å 'diagnosis', –¥–∏–∑–±–∞–ª–∞–Ω—Å ~3:2.
–ú–µ—Ç–∞: –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–Ω –∫—Ä–æ–∫—ñ–≤ –¥–ª—è baseline + AutoML –∑ —Ç—Ä–µ–∫—ñ–Ω–≥–æ–º —É¬† MLFlow.
–û–±–º–µ–∂–µ–Ω–Ω—è: –±–µ–∑ Docker, –ª–æ–∫–∞–ª—å–Ω–∏–π –Ω–æ—É—Ç–±—É–∫, –±–µ–∑ GPU, —á–∞—Å –Ω–∞ AutoML 15 —Ö–≤.
–§–æ—Ä–º–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
¬† 1) –î–µ—Ä–µ–≤–æ.
¬† 2) config.yaml
¬† 3) .gitignore
¬† 4) requirements.txt.
–ó–∞–¥–∞–Ω–Ω—è: –ó–≥–µ–Ω–µ—Ä—É–π –¥–µ—Ä–µ–≤–æ –ø–∞–ø–æ–∫ –ø—ñ–¥ ML –ø—Ä–æ–µ–∫—Ç —ñ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π configs/config.yaml
–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–¶–µ —á—É–¥–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç—É. –û—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –Ω–∞ Linux –±–µ–∑ Docker, –º–∏ –ø–æ–±—É–¥—É—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–∫, —â–æ–± –≤–æ–Ω–∞ –±—É–ª–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–∏—Å—Ç–æ—é —Ç–∞ –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—é —á–µ—Ä–µ–∑ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –æ—Ç–æ—á–µ–Ω–Ω—è (`venv`).

–û—Å—å –≥–æ—Ç–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è –∑–≥—ñ–¥–Ω–æ –∑ –≤–∞—à–∏–º–∏ –≤–∏–º–æ–≥–∞–º–∏:

### 1\. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É (–î–µ—Ä–µ–≤–æ)

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å–ø—Ä–æ—â–µ–Ω—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É *Cookiecutter Data Science*, –∞–¥–∞–ø—Ç–æ–≤–∞–Ω—É –ø—ñ–¥ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å —Ç–∞ –ª–æ–∫–∞–ª—å–Ω–∏–π MLFlow.

```text
mlops_h2o_project/
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml          # –í—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—É—Ç (—à–ª—è—Ö–∏, –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/                 # –°—é–¥–∏ –ø–æ–∫–ª–∞—Å—Ç–∏ –≤–∞—à –≤–∏—Ö—ñ–¥–Ω–∏–π CSV
‚îÇ   ‚îî‚îÄ‚îÄ processed/           # –î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö (—è–∫—â–æ —Ç—Ä–µ–±–∞)
‚îú‚îÄ‚îÄ mlruns/                  # –¢—É—Ç MLFlow –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –∞—Ä—Ç–∏—Ñ–∞–∫—Ç–∏
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ 01_h2o_automl.ipynb  # –û—Å–Ω–æ–≤–Ω–∏–π —Ä–æ–±–æ—á–∏–π –∑–æ—à–∏—Ç
‚îú‚îÄ‚îÄ src/                     # –î–æ–ø–æ–º—ñ–∂–Ω–∏–π –∫–æ–¥ (—â–æ–± –Ω–µ –∑–∞—Å–º—ñ—á—É–≤–∞—Ç–∏ –Ω–æ—É—Ç–±—É–∫)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py             # –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è YAML
‚îú‚îÄ‚îÄ .gitignore               # –í–∞–∂–ª–∏–≤–æ –¥–ª—è git
‚îú‚îÄ‚îÄ README.md                # –û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É
‚îî‚îÄ‚îÄ requirements.txt         # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```

-----

### 2\. configs/config.yaml

–¶–µ–π —Ñ–∞–π–ª –¥–æ–∑–≤–æ–ª—è—î –∫–µ—Ä—É–≤–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–º –±–µ–∑ –∑–º—ñ–Ω–∏ –∫–æ–¥—É. –Ø –≤—Ä–∞—Ö—É–≤–∞–≤ –æ–±–º–µ–∂–µ–Ω–Ω—è —É 15 —Ö–≤–∏–ª–∏–Ω —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫—É –¥–∞–Ω–∏—Ö.

```yaml
project:
  name: "h2o_automl_diagnosis"
  random_state: 42
  experiment_name: "H2O_AutoML_Baseline"

data:
  raw_path: "../data/raw/data.csv"
  processed_path: "../data/processed/"
  target_col: "diagnosis"
  id_col: null            # –í–∫–∞–∂—ñ—Ç—å, —è–∫—â–æ —î ID –∫–æ–ª–æ–Ω–∫–∏, —è–∫—É —Ç—Ä–µ–±–∞ –≤–∏–¥–∞–ª–∏—Ç–∏

model:
  type: "binary_classification"
  balance_classes: true   # –ö–æ—Ä–∏—Å–Ω–æ, –±–æ —É –≤–∞—Å –¥–∏–∑–±–∞–ª–∞–Ω—Å 3:2
  folds: 5                # –ö—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è

h2o_automl:
  max_runtime_secs: 900   # 15 —Ö–≤–∏–ª–∏–Ω (–∂–æ—Ä—Å—Ç–∫–µ –æ–±–º–µ–∂–µ–Ω–Ω—è)
  max_models: 20          # –î–æ–¥–∞—Ç–∫–æ–≤–µ –æ–±–º–µ–∂–µ–Ω–Ω—è, —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ RAM
  exclude_algos:          # –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–∞ –≤–∏–∫–ª—é—á–∏—Ç–∏ "DeepLearning" –±–µ–∑ GPU
    - "DeepLearning"      # DL –Ω–∞ CPU –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω–∏–º, –∫—Ä–∞—â–µ GBM/XGBoost
  sort_metric: "AUC"      # –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

mlflow:
  tracking_uri: "../mlruns"
```

-----

### 3\. .gitignore

–ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —Ç–∞ –ª–æ–∫–∞–ª—å–Ω—ñ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ –º–æ–¥–µ–ª–µ–π —É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π.

```gitignore
# Byte-compiled / optimized / DLL files
__pycache__/
*.py[cod]
*$py.class

# C extensions
*.so

# Distribution / packaging
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Jupyter Notebook
.ipynb_checkpoints

# Virtual Environment
venv/
env/
ENV/

# Data (Never commit data!)
data/raw/*
data/processed/*
!data/raw/.gitkeep
!data/processed/.gitkeep

# MLFlow & H2O artifacts
mlruns/
h2o_models/
*.zip
```

-----

### 4\. requirements.txt

–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –±—ñ–±–ª—ñ–æ—Ç–µ–∫ –¥–ª—è –≤–∞—à–æ–≥–æ Python 3.12. H2O –ø–æ—Ç—Ä–µ–±—É—î Java (JDK), –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–æ–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ Linux (`sudo apt install default-jdk`).

```text
# Data Manipulation
pandas>=2.1.0
numpy>=1.26.0

# AutoML
h2o>=3.44.0.3

# Experiment Tracking
mlflow>=2.9.0

# Configuration
pyyaml>=6.0.1

# Visualization & Utils
matplotlib>=3.8.0
seaborn>=0.13.0
scikit-learn>=1.3.0  # –î–ª—è –º–µ—Ç—Ä–∏–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∞–±–æ —Å–ø–ª—ñ—Ç—É –¥–∞–Ω–∏—Ö

# Jupyter
jupyterlab>=4.0.0
ipykernel>=6.29.0
```

-----

### –©–æ –¥–∞–ª—ñ?

–©–æ–± –ø–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ:

1.  `python3.12 -m venv venv`
2.  `source venv/bin/activate`
3.  `pip install -r requirements.txt`

–ß–∏ –±–∞–∂–∞—î—Ç–µ –≤–∏, —â–æ–± —è –Ω–∞–ø–∏—Å–∞–≤ **–∫–æ–¥ –¥–ª—è `src/utils.py`** (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É) —Ç–∞ **—à–∞–±–ª–æ–Ω Notebook-–∞**, —è–∫–∏–π —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î H2O —Ç–∞ –ª–æ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ MLFlow?



–ó–∞–ø–∏—Ç:
–î–∞–π –∫–æ–¥ –¥–ª—è baseline (LogisticRegression) –∑ —á–∏—Ç–∞–Ω–Ω—è–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —ñ–∑ configs/config.yml —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è–º train/test, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è–º accuracy, precision, recall, —Ç–∞ f1 (macro), —ñ –ª–æ–≥—É–≤–∞–Ω–Ω—è–º —É MLflow (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –º–µ—Ç—Ä–∏–∫–∏, –º–∞—Ç—Ä–∏—Ü—è –∑–º—ñ—à—É–≤–∞–Ω–Ω—è —è–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç).
–§–æ—Ä–º–∞—Ç:
¬† 1) train.py (–∫–æ–¥-–±–ª–æ–∫);
¬† 2) evaluate.py (–∫–æ–¥-–±–ª–æ–∫);
¬† 3) –∫–æ–º–∞–Ω–¥–∏ –∑–∞–ø—É—Å–∫—É.
–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–û—Å—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è **Baseline** —Ä—ñ—à–µ–Ω–Ω—è. –ú–∏ —Ä–æ–∑–¥—ñ–ª–∏–º–æ –ø—Ä–æ—Ü–µ—Å –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è (`train.py`) —Ç–∞ –æ—Ü—ñ–Ω–∫—É (`evaluate.py`), —â–æ —î –≥–∞—Ä–Ω–æ—é –ø—Ä–∞–∫—Ç–∏–∫–æ—é –≤ MLOps –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ.

–°–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞–π—Ç–µ —Ü—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —É –≤–∞—à `configs/config.yaml` (–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ):

```yaml
# configs/config.yaml (–¥–æ–¥–∞—Ç–∫–æ–≤–∞ —Å–µ–∫—Ü—ñ—è)
split:
  test_size: 0.2
  random_state: 42

logistic_regression:
  C: 1.0
  solver: "lbfgs"
  max_iter: 1000

paths:
  model_output: "../models/baseline_model.pkl"
  test_data_output: "../data/processed/test_data.csv"
```

-----

### 1\. `src/train.py`

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –¥–∞–Ω—ñ, —Ä–æ–∑–¥—ñ–ª—è—î —ó—Ö, —Ç—Ä–µ–Ω—É—î –º–æ–¥–µ–ª—å —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î —ó—ó (pickle) —Ä–∞–∑–æ–º —ñ–∑ —Ç–µ—Å—Ç–æ–≤–∏–º –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–∏—Ö –¥–ª—è –µ—Ç–∞–ø—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.

```python
import pandas as pd
import yaml
import pickle
import os
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.pipeline import make_pipeline

# 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
with open("configs/config.yaml", "r") as f:
    config = yaml.safe_load(f)

# 2. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö
print("Loading data...")
df = pd.read_csv(config['data']['raw_path'])

# –ü—Ä–æ—Å—Ç–∞ –æ–±—Ä–æ–±–∫–∞: –≤–∏–¥–∞–ª–µ–Ω–Ω—è ID (—è–∫—â–æ —î) —Ç–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó
if config['data']['id_col'] and config['data']['id_col'] in df.columns:
    df = df.drop(columns=[config['data']['id_col']])

target = config['data']['target_col']
X = df.drop(columns=[target])
y = df[target]

# –Ø–∫—â–æ —Ü—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤–∞ (B/M), –∫–æ–¥—É—î–º–æ –≤ 0/1
if y.dtype == 'object':
    le = LabelEncoder()
    y = le.fit_transform(y)

# 3. –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è (Train/Test)
print("Splitting data...")
X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=config['split']['test_size'],
    random_state=config['split']['random_state'],
    stratify=y # –í–∞–∂–ª–∏–≤–æ –ø—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å—ñ
)

# 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–π–ø–ª–∞–π–Ω—É (Scaling + LogReg)
# LogisticRegression —á—É—Ç–ª–∏–≤–∏–π –¥–æ –º–∞—Å—à—Ç–∞–±—É, —Ç–æ–º—É –¥–æ–¥–∞—î–º–æ StandardScaler
model = make_pipeline(
    StandardScaler(),
    LogisticRegression(
        C=config['logistic_regression']['C'],
        solver=config['logistic_regression']['solver'],
        max_iter=config['logistic_regression']['max_iter'],
        random_state=config['project']['random_state']
    )
)

# 5. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
print("Training Baseline model...")
model.fit(X_train, y_train)

# 6. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ –¥–ª—è –µ—Ç–∞–ø—É evaluate
os.makedirs(os.path.dirname(config['paths']['model_output']), exist_ok=True)
os.makedirs(os.path.dirname(config['paths']['test_data_output']), exist_ok=True)

# –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –º–æ–¥–µ–ª—å
with open(config['paths']['model_output'], 'wb') as f:
    pickle.dump(model, f)

# –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ç–µ—Å—Ç–æ–≤–∏–π –Ω–∞–±—ñ—Ä (X + y) –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
test_df = X_test.copy()
test_df[target] = y_test
test_df.to_csv(config['paths']['test_data_output'], index=False)

print(f"Training complete. Model saved to {config['paths']['model_output']}")
```

-----

### 2\. `src/evaluate.py`

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ MLflow. –í—ñ–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–±–µ—Ä–µ–∂–µ–Ω—É –º–æ–¥–µ–ª—å —ñ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ, —Ä–∞—Ö—É—î –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –±—É–¥—É—î –≥—Ä–∞—Ñ—ñ–∫–∏.

```python
import pandas as pd
import yaml
import pickle
import matplotlib.pyplot as plt
import seaborn as sns
import mlflow
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, confusion_matrix

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è matplotlib –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ (–±–µ–∑ GUI)
plt.switch_backend('Agg')

# 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
with open("configs/config.yaml", "r") as f:
    config = yaml.safe_load(f)

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è MLFlow
mlflow.set_tracking_uri(config['mlflow']['tracking_uri'])
mlflow.set_experiment(config['project']['experiment_name'])

def evaluate():
    print("Starting evaluation...")
    
    # 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ —Ç–∞ –¥–∞–Ω–∏—Ö
    with open(config['paths']['model_output'], 'rb') as f:
        model = pickle.load(f)
    
    test_df = pd.read_csv(config['paths']['test_data_output'])
    target_col = config['data']['target_col']
    
    X_test = test_df.drop(columns=[target_col])
    y_test = test_df[target_col]

    # 3. –ü–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è
    y_pred = model.predict(X_test)

    # 4. –û–±—á–∏—Å–ª–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫
    metrics = {
        "accuracy": accuracy_score(y_test, y_pred),
        "precision": precision_score(y_test, y_pred, average='macro'),
        "recall": recall_score(y_test, y_pred, average='macro'),
        "f1_macro": f1_score(y_test, y_pred, average='macro')
    }

    print(f"Metrics: {metrics}")

    # 5. –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤ MLFlow
    with mlflow.start_run(run_name="Baseline_LogReg"):
        # –õ–æ–≥—É—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (–∑ –∫–æ–Ω—Ñ—ñ–≥—É)
        mlflow.log_params(config['logistic_regression'])
        mlflow.log_param("test_size", config['split']['test_size'])
        
        # –õ–æ–≥—É—î–º–æ –º–µ—Ç—Ä–∏–∫–∏
        mlflow.log_metrics(metrics)

        # 6. –ú–∞—Ç—Ä–∏—Ü—è –∑–º—ñ—à—É–≤–∞–Ω–Ω—è (Confusion Matrix)
        cm = confusion_matrix(y_test, y_pred)
        
        plt.figure(figsize=(6, 5))
        sns.heatmap(cm, annot=True, fmt='d', cmap='Blues')
        plt.title('Confusion Matrix')
        plt.ylabel('True Label')
        plt.xlabel('Predicted Label')
        
        # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
        plot_path = "confusion_matrix.png"
        plt.savefig(plot_path)
        plt.close()
        
        # –õ–æ–≥—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ —è–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É
        mlflow.log_artifact(plot_path)
        
        # –õ–æ–≥—É–≤–∞–Ω–Ω—è —Å–∞–º–æ—ó –º–æ–¥–µ–ª—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, sklearn —Ñ–æ—Ä–º–∞—Ç)
        mlflow.sklearn.log_model(model, "model")
        
        print("Evaluation logged to MLFlow successfully.")

if __name__ == "__main__":
    evaluate()
```

-----

### 3\. –ö–æ–º–∞–Ω–¥–∏ –∑–∞–ø—É—Å–∫—É

–í–∏–∫–æ–Ω—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–∏ –∑ –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç—É (`mlops_h2o_project/`):

1.  **–ê–∫—Ç–∏–≤—É–π—Ç–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ (—è–∫—â–æ —â–µ –Ω–µ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ):**

    ```bash
    source venv/bin/activate
    ```

2.  **–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è:**

    ```bash
    # –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø–∞–ø–∫–∞ models —ñ—Å–Ω—É—î, –∞–±–æ —Å–∫—Ä–∏–ø—Ç —ó—ó —Å—Ç–≤–æ—Ä–∏—Ç—å
    python src/train.py
    ```

3.  **–ó–∞–ø—É—Å—Ç—ñ—Ç—å –æ—Ü—ñ–Ω–∫—É (–ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ MLFlow):**

    ```bash
    python src/evaluate.py
    ```

4.  **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
    –ó–∞–ø—É—Å—Ç—ñ—Ç—å —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å MLFlow —ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ –∞–¥—Ä–µ—Å–æ—é [http://127.0.0.1:5000](https://www.google.com/search?q=http://127.0.0.1:5000)

    ```bash
    mlflow ui --backend-store-uri mlruns
    ```

### –ß–∏ –±–∞–∂–∞—î—Ç–µ –≤–∏, —â–æ–± —è –ø–æ–∫–∞–∑–∞–≤, —è–∫ —Ç–µ–ø–µ—Ä —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ H2O AutoML —É —Ü–µ–π —Å–∞–º–∏–π –ø–∞–π–ø–ª–∞–π–Ω (—É —Ñ–∞–π–ª `01_h2o_automl.ipynb`), —â–æ–± –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –π–æ–≥–æ –∑ —Ü–∏–º Baseline?


–ó–∞–ø–∏—Ç:
–ó–∞–ø—Ä–æ–ø–æ–Ω—É–π –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ-–ª—ñ–¥–µ—Ä–∞, —â–æ –±—É–¥–µ –ø—ñ–∑–Ω—ñ—à–µ –æ—Ç—Ä–∏–º–∞–Ω–æ –∑ H2O AutoML

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–î–ª—è –∑–∞–¥–∞—á—ñ **–º–µ–¥–∏—á–Ω–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏** –∑ –ø–æ–º—ñ—Ä–Ω–∏–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º (3:2), –≤–∏–±—ñ—Ä –º–µ—Ç—Ä–∏–∫ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ. –£ –º–µ–¥–∏—Ü–∏–Ω—ñ —Ü—ñ–Ω–∞ –ø–æ–º–∏–ª–∫–∏ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Ö–≤–æ—Ä–æ–±—É) –∑–∞–∑–≤–∏—á–∞–π –≤–∏—â–∞, –Ω—ñ–∂ —Ö–∏–±–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞.

–û—Å—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –Ω–∞–±—ñ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –ª—ñ–¥–µ—Ä–∞ H2O AutoML –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º, —á–æ–º—É –≤–æ–Ω–∏ –≤–∞–∂–ª–∏–≤—ñ —Å–∞–º–µ —Ç—É—Ç:

### 1\. –û—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ (Must-have)

–¶—ñ –º–µ—Ç—Ä–∏–∫–∏ —Ç—Ä–µ–±–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ª–æ–≥—É–≤–∞—Ç–∏ –≤ MLflow –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ Baseline.

  * **AUC-ROC (Area Under the Curve):**
      * *–ß–æ–º—É:* –¶–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è AutoML. –í–æ–Ω–∞ –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –º–æ–¥–µ–ª—å –≤–º—ñ—î —Ä–æ–∑–¥—ñ–ª—è—Ç–∏ –∫–ª–∞—Å–∏ (—Ö–≤–æ—Ä–∏–π/–∑–¥–æ—Ä–æ–≤–∏–π) –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –æ–±—Ä–∞–Ω–æ–≥–æ –ø–æ—Ä–æ–≥—É (threshold).
      * *–î–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å—É:* –°—Ç—ñ–π–∫–∞ –¥–æ –ø–æ–º—ñ—Ä–Ω–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É (3:2).
  * **Recall (–ü–æ–≤–Ω–æ—Ç–∞ / Sensitivity):**
      * *–ß–æ–º—É:* **–ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∞ –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω–∏.** –í–æ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è: "–°–∫—ñ–ª—å–∫–æ—Ö —Ö–≤–æ—Ä–∏—Ö –º–∏ —Ä–µ–∞–ª—å–Ω–æ –∑–Ω–∞–π—à–ª–∏?". –ù–∏–∑—å–∫–∏–π Recall –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∏ –≤—ñ–¥–ø—É—Å–∫–∞—î–º–æ –¥–æ–¥–æ–º—É —Ö–≤–æ—Ä–∏—Ö –ª—é–¥–µ–π.
  * **Precision (–¢–æ—á–Ω—ñ—Å—Ç—å):**
      * *–ß–æ–º—É:* –ü–æ–∫–∞–∑—É—î, —Å–∫—ñ–ª—å–∫–∏ –∑ —Ç–∏—Ö, –∫–æ–≥–æ –º–∏ –Ω–∞–∑–≤–∞–ª–∏ "—Ö–≤–æ—Ä–∏–º–∏", —Å–ø—Ä–∞–≤–¥—ñ —Ö–≤–æ—Ä—ñ. –ù–∏–∑—å–∫–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –æ–∑–Ω–∞—á–∞—î –±–∞–≥–∞—Ç–æ —Ö–∏–±–Ω–∏—Ö —Ç—Ä–∏–≤–æ–≥ (—Å—Ç—Ä–µ—Å –¥–ª—è –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤, –∑–∞–π–≤—ñ –∞–Ω–∞–ª—ñ–∑–∏).
  * **F1-Score (Macro):**
      * *–ß–æ–º—É:* –ì–∞—Ä–º–æ–Ω—ñ—á–Ω–µ —Å–µ—Ä–µ–¥–Ω—î –º—ñ–∂ Precision —Ç–∞ Recall. –î–∞—î –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏ –±–∞–ª–∞–Ω—Å—É.

### 2\. –ü—Ä–æ—Å—É–Ω—É—Ç—ñ –º–µ—Ç—Ä–∏–∫–∏ (Nice-to-have)

–î–ª—è –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –≤ —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫—ñ–π —Ä–æ–±–æ—Ç—ñ:

  * **F2-Score:**
      * *–ß–æ–º—É:* –¶–µ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è F1, —è–∫–∞ **–Ω–∞–¥–∞—î –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç Recall** (–≤–¥–≤—ñ—á—ñ –≤–∞–∂–ª–∏–≤—ñ—à–µ –∑–∞ Precision). –¶–µ —ñ–¥–µ–∞–ª—å–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –≤–∏–±–æ—Ä—É "—Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó" –º–æ–¥–µ–ª—ñ –≤ –º–µ–¥–∏—Ü–∏–Ω—ñ.
      * *–§–æ—Ä–º—É–ª–∞:* $F2 = (1 + 2^2) \cdot \frac{Precision \cdot Recall}{(2^2 \cdot Precision) + Recall}$
  * **LogLoss (Logarithmic Loss):**
      * *–ß–æ–º—É:* H2O —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ó—ó –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó. –í–æ–Ω–∞ –∫–∞—Ä–∞—î –º–æ–¥–µ–ª—å –∑–∞ "–≤–ø–µ–≤–Ω–µ–Ω—ñ" –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–¥–µ–ª—å –Ω–∞ 99% –≤–ø–µ–≤–Ω–µ–Ω–∞, —â–æ –ø–∞—Ü—ñ—î–Ω—Ç –∑–¥–æ—Ä–æ–≤–∏–π, –∞ –≤—ñ–Ω —Ö–≤–æ—Ä–∏–π).
  * **Specificity (–°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ—Å—Ç—å):**
      * *–ß–æ–º—É:* –ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∑–Ω–∞—á–∞—Ç–∏ *–∑–¥–æ—Ä–æ–≤–∏—Ö* –ª—é–¥–µ–π.

### 3\. –Ø–∫ –¥—ñ—Å—Ç–∞—Ç–∏ —Ü—ñ –º–µ—Ç—Ä–∏–∫–∏ –∑ H2O (Code snippet)

H2O –æ–±'—î–∫—Ç–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥ Scikit-Learn. –í–æ–Ω–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –æ–±'—î–∫—Ç–∞ –º–æ–¥–µ–ª—ñ.

–û—Å—å —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫—É –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –≤ `src/utils.py` –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤ –Ω–æ—É—Ç–±—É—Ü—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ª–æ–≤–Ω–∏–∫–∞ –º–µ—Ç—Ä–∏–∫ –¥–ª—è MLFlow:

```python
from h2o.model.metrics_base import H2OMetrics
import h2o

def get_h2o_metrics(model, test_frame):
    """
    –í–∏—Ç—è–≥—É—î –º–µ—Ç—Ä–∏–∫–∏ –∑ –º–æ–¥–µ–ª—ñ H2O –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.
    –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ª–æ–≤–Ω–∏–∫ –¥–ª—è MLflow.
    """
    # –ì–µ–Ω–µ—Ä—É—î–º–æ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Å–µ—Ç—ñ
    perf = model.model_performance(test_frame)
    
    # –û—Ç—Ä–∏–º—É—î–º–æ confusion matrix —è–∫ —Ç–∞–±–ª–∏—Ü—é H2O (–¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É F2)
    # H2O –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–±–∏—Ä–∞—î –ø–æ—Ä—ñ–≥ –∑–∞ F1-score, –∞–ª–µ –º–æ–∂–Ω–∞ –±—Ä–∞—Ç–∏ 'max_recall'
    cm = perf.confusion_matrix() 
    
    # –í–∏—Ç—è–≥—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è (–¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)
    # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CM –≤ H2O: [TN, FP], [FN, TP] (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–µ—Ä—Å—ñ—ó, –∫—Ä–∞—â–µ –±—Ä–∞—Ç–∏ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥–∏)
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –º–µ—Ç–æ–¥–∏ H2O
    metrics = {
        "h2o_auc": perf.auc(),
        "h2o_logloss": perf.logloss(),
        "h2o_accuracy": perf.accuracy()[0][1], # [0][1] –±–µ—Ä–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥—É
        "h2o_precision": perf.precision()[0][1],
        "h2o_recall": perf.recall()[0][1],     # –¶–µ —ñ —î Sensitivity
        "h2o_f1": perf.F1()[0][1]
    }
    
    # –†—É—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ F2-score (–æ—Å–∫—ñ–ª—å–∫–∏ H2O –π–æ–≥–æ –ø—Ä—è–º–æ –Ω–µ –≤—ñ–¥–¥–∞—î –≤ perf)
    p = metrics["h2o_precision"]
    r = metrics["h2o_recall"]
    if p + r > 0:
        metrics["h2o_f2"] = (5 * p * r) / (4 * p + r)
    else:
        metrics["h2o_f2"] = 0.0
        
    return metrics
```

### 4\. –ü–æ—Ä–∞–¥–∞ –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤ MLFlow

H2O –º–∞—î —á—É–¥–æ–≤—ñ –≤–±—É–¥–æ–≤–∞–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∏. –£ –Ω–æ—É—Ç–±—É—Ü—ñ –∞–±–æ —Å–∫—Ä–∏–ø—Ç—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –∑–±–µ—Ä–µ–∂—ñ—Ç—å **ROC Curve** —è–∫ –∫–∞—Ä—Ç–∏–Ω–∫—É —ñ –∑–∞–ª–æ–≥—ñ—Ç—å —ó—ó —è–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç:

```python
import matplotlib.pyplot as plt

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—É
perf = leader_model.model_performance(test_h2o)
fpr = perf.fprs
tpr = perf.tprs

# –ü–æ–±—É–¥–æ–≤–∞
plt.figure(figsize=(6,6))
plt.plot(fpr, tpr, label=f"AUC = {perf.auc():.3f}")
plt.plot([0, 1], [0, 1], 'k--')
plt.xlabel("False Positive Rate")
plt.ylabel("True Positive Rate (Recall)")
plt.title("H2O Leader ROC Curve")
plt.legend()
plt.savefig("h2o_roc_curve.png")

# –õ–æ–≥—É–≤–∞–Ω–Ω—è
mlflow.log_artifact("h2o_roc_curve.png")
```

–ó–∞–ø–∏—Ç:
–ù–∞–ø–∏—à–∏ –∫–æ–¥ –¥–ª—è –∑–∞–ø—É—Å–∫—É H2O AutoML –∑–∞ –ø–∞—Ä–∞–º—Ç–µ—Ä–∞–º–∏, –≤–∫–∞–∑–∞–Ω–∏–º–∏ —É config.yaml —ñ–∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è–º —É MLflow.
–í–∫–ª—é—á–∏ —Ç–∞–∫–æ–∂ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é H2O, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ª—ñ–¥–µ—Ä–±–æ—Ä–¥—É (–Ω–∞–π–∫—Ä–∞—â—ñ 5), –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ª—ñ–¥–µ—Ä–∞ –Ω–∞ test (accuracy, precision, recall, –º–∞—Ç—Ä–∏—Ü—è –∑–º—ñ—à—É–≤–∞–Ω–Ω—è, AUC-ROC).
–§–æ—Ä–º–∞—Ç:
¬† 1) automl_run.py (–∫–æ–¥-–±–ª–æ–∫);
¬† 2) –∫–æ–º–∞–Ω–¥–∏ CLI;

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–û—Å—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∫—Ä–∏–ø—Ç—É `src/automl_run.py`, —è–∫–∏–π –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–Ω—Ç–µ–≥—Ä—É—î H2O AutoML –∑ MLflow, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤–∞—à `config.yaml`.

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î –ø–æ–≤–Ω–∏–π —Ü–∏–∫–ª: —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è -\> –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö -\> –Ω–∞–≤—á–∞–Ω–Ω—è (AutoML) -\> –≤–∏–±—ñ—Ä –ª—ñ–¥–µ—Ä–∞ -\> –æ—Ü—ñ–Ω–∫–∞ -\> –ª–æ–≥—É–≤–∞–Ω–Ω—è.

### 1\. `src/automl_run.py`

```python
import h2o
from h2o.automl import H2OAutoML
import mlflow
import mlflow.h2o
import yaml
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import os

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –±–µ–∑ GUI (Linux server/terminal)
plt.switch_backend('Agg')

def load_config(path="configs/config.yaml"):
    with open(path, "r") as f:
        return yaml.safe_load(f)

def run_automl():
    # 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    cfg = load_config()
    
    # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è H2O (–ª–æ–∫–∞–ª—å–Ω–∏–π –∫–ª–∞—Å—Ç–µ—Ä)
    # nthreads=-1 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤—Å—ñ —è–¥—Ä–∞ CPU
    print("Initializing H2O...")
    h2o.init(nthreads=-1, max_mem_size='2G') # –ú–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏ RAM, —è–∫—â–æ —î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å
    
    # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è MLflow
    mlflow.set_tracking_uri(cfg['mlflow']['tracking_uri'])
    mlflow.set_experiment(cfg['project']['experiment_name'])
    
    with mlflow.start_run(run_name="H2O_AutoML_Run"):
        print("Loading data...")
        
        # 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤ H2OFrame
        # –í–∞—Ä—ñ–∞–Ω—Ç –ê: –ß–∏—Ç–∞—î–º–æ raw (—è–∫—â–æ processed —â–µ –Ω–µ–º–∞—î)
        data_path = cfg['data']['raw_path']
        df_h2o = h2o.import_file(data_path)
        
        target = cfg['data']['target_col']
        
        # –í–∏–¥–∞–ª–µ–Ω–Ω—è ID, —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ
        if cfg['data']['id_col'] and cfg['data']['id_col'] in df_h2o.columns:
            df_h2o = df_h2o.drop(cfg['data']['id_col'])
        
        # –í–ê–ñ–õ–ò–í–û: –î–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ü—ñ–ª—å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –ú–ê–Ñ –±—É—Ç–∏ —Ñ–∞–∫—Ç–æ—Ä–æ–º (enum)
        df_h2o[target] = df_h2o[target].asfactor()
        
        # 3. –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (Train / Test)
        # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ split_frame –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É H2O
        splits = df_h2o.split_frame(ratios=[1 - cfg['split']['test_size']], 
                                    seed=cfg['split']['random_state'])
        train = splits[0]
        test = splits[1]
        
        print(f"Train size: {train.nrow}, Test size: {test.nrow}")
        
        # –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ–∑–Ω–∞–∫ (x) —Ç–∞ —Ü—ñ–ª—ñ (y)
        y = target
        x = df_h2o.columns
        x.remove(y)
        
        # 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫ AutoML
        print(f"Starting AutoML for {cfg['h2o_automl']['max_runtime_secs']} seconds...")
        
        aml = H2OAutoML(
            max_runtime_secs=cfg['h2o_automl']['max_runtime_secs'],
            max_models=cfg['h2o_automl']['max_models'],
            seed=cfg['project']['random_state'],
            sort_metric=cfg['h2o_automl']['sort_metric'],
            exclude_algos=cfg['h2o_automl'].get('exclude_algos', []),
            balance_classes=cfg['model']['balance_classes'],
            project_name=cfg['project']['name']
        )
        
        aml.train(x=x, y=y, training_frame=train)
        
        # 5. –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ª—ñ–¥–µ—Ä–±–æ—Ä–¥—É
        lb = aml.leaderboard
        print("Leaderboard (Top 5):")
        print(lb.head(rows=5))
        
        # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ª—ñ–¥–µ—Ä–±–æ—Ä–¥—É —è–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç (HTML —Ç–∞ CSV)
        lb_df = lb.as_data_frame()
        lb_df.head(10).to_csv("leaderboard.csv", index=False)
        mlflow.log_artifact("leaderboard.csv")
        
        # 6. –û—Ü—ñ–Ω–∫–∞ –ª—ñ–¥–µ—Ä–∞ (Best Model)
        leader = aml.leader
        print(f"Leader Model: {leader.model_id}")
        
        # –û—Ç—Ä–∏–º—É—î–º–æ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ TEST dataset
        perf = leader.model_performance(test)
        
        # –í–∏—Ç—è–≥—É—î–º–æ –º–µ—Ç—Ä–∏–∫–∏ (–¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)
        # H2O –ø–æ–≤–µ—Ä—Ç–∞—î —Ç–∞–±–ª–∏—Ü—ñ –ø–æ—Ä–æ–≥—ñ–≤, –±–µ—Ä–µ–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ F1
        metrics = {
            "auc": perf.auc(),
            "logloss": perf.logloss(),
            "accuracy": perf.accuracy()[0][1], # [0] - max threshold metric
            "precision": perf.precision()[0][1],
            "recall": perf.recall()[0][1],
            "f1": perf.F1()[0][1]
        }
        
        print("Test Metrics:", metrics)
        mlflow.log_metrics(metrics)
        
        # –õ–æ–≥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ AutoML
        mlflow.log_params({
            "max_runtime": cfg['h2o_automl']['max_runtime_secs'],
            "leader_algo": leader.algo,
            "balance_classes": cfg['model']['balance_classes']
        })

        # 7. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è: Confusion Matrix (Heatmap)
        # –û—Ç—Ä–∏–º—É—î–º–æ –º–∞—Ç—Ä–∏—Ü—é —è–∫ Pandas DataFrame
        cm_table = perf.confusion_matrix().table.as_data_frame()
        # –ó–∞–∑–≤–∏—á–∞–π H2O –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –¥–µ –æ—Å—Ç–∞–Ω–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ - —Ü–µ totals/rates
        # –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∞ –ª–∏—à–µ –º–∞—Ç—Ä–∏—Ü—è N x N (–ø–µ—Ä—à—ñ 2x2 –¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó)
        cm_matrix = cm_table.iloc[0:2, 1:3].astype(int) # –∫–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—ñ–≤ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–µ—Ä—Å—ñ—ó, –∑–∞–∑–≤–∏—á–∞–π 1:3 —Ü–µ predicted –∫–ª–∞—Å–∏
        
        plt.figure(figsize=(6, 5))
        sns.heatmap(cm_matrix, annot=True, fmt='d', cmap='Greens')
        plt.title(f'Confusion Matrix ({leader.model_id})')
        plt.ylabel('Actual')
        plt.xlabel('Predicted')
        plt.savefig("h2o_confusion_matrix.png")
        plt.close()
        mlflow.log_artifact("h2o_confusion_matrix.png")

        # 8. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è: ROC Curve
        fpr = perf.fprs
        tpr = perf.tprs
        plt.figure(figsize=(6, 6))
        plt.plot(fpr, tpr, label=f"AUC = {perf.auc():.3f}")
        plt.plot([0, 1], [0, 1], 'k--')
        plt.xlabel("False Positive Rate")
        plt.ylabel("True Positive Rate")
        plt.title("ROC Curve")
        plt.legend()
        plt.savefig("h2o_roc_curve.png")
        plt.close()
        mlflow.log_artifact("h2o_roc_curve.png")

        # 9. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
        # MLflow –º–∞—î –Ω–∞—Ç–∏–≤–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É H2O, —Ü–µ –∑–±–µ—Ä–µ–∂–µ –º–æ–¥–µ–ª—å —É —Ñ–æ—Ä–º–∞—Ç—ñ, –ø—Ä–∏–¥–∞—Ç–Ω–æ–º—É –¥–ª—è serving
        mlflow.h2o.log_model(leader, "h2o_best_model")
        
        print("AutoML run completed and logged to MLflow.")

if __name__ == "__main__":
    try:
        run_automl()
    except Exception as e:
        print(f"Error occurred: {e}")
    # finally:
        # h2o.shutdown(prompt=False) # –†–æ–∑–∫–æ–º–µ–Ω—Ç—É–π—Ç–µ, —è–∫—â–æ —Ö–æ—á–µ—Ç–µ –∞–≤—Ç–æ-–≤–∏–º–∫–Ω–µ–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞
```

-----

### 2\. –ö–æ–º–∞–Ω–¥–∏ CLI

–í–∏–∫–æ–Ω—É–π—Ç–µ –∑ –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç—É (`mlops_h2o_project/`).

**–ö—Ä–æ–∫ 1: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**

```bash
source venv/bin/activate
```

**–ö—Ä–æ–∫ 2: –ó–∞–ø—É—Å–∫ AutoML**
–¶–µ–π –ø—Ä–æ—Ü–µ—Å –∑–∞–π–º–µ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–æ–π —á–∞—Å, —è–∫–∏–π –≤–∏ –≤–∫–∞–∑–∞–ª–∏ —É `max_runtime_secs` + —á–∞—Å –Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (–±–ª–∏–∑—å–∫–æ 16-17 —Ö–≤–∏–ª–∏–Ω –∑–∞–≥–∞–ª–æ–º).

```bash
python src/automl_run.py
```

**–ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (Dashboard)**
–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä MLflow —â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π:

```bash
mlflow ui --backend-store-uri mlruns
```

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `http://127.0.0.1:5000` —É –±—Ä–∞—É–∑–µ—Ä—ñ.

**–ö—Ä–æ–∫ 4: (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) –ü–µ—Ä–µ–≥–ª—è–¥ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É H2O Flow**
–ü–æ–∫–∏ —Å–∫—Ä–∏–ø—Ç –ø—Ä–∞—Ü—é—î (–∞–±–æ —è–∫—â–æ –≤–∏ –∑–∞–∫–æ–º–µ–Ω—Ç—É–≤–∞–ª–∏ `h2o.shutdown`), –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ —Ö—ñ–¥ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ —É "—Ä—ñ–¥–Ω–æ–º—É" —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ H2O.
–í—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ: `http://localhost:54321`

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:

1.  **H2O Init:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–∞—Ä–∞–º–µ—Ç—Ä `max_mem_size='2G'`, —â–æ–± –Ω–µ "–∑'—ó—Å—Ç–∏" –≤—Å—é –ø–∞–º'—è—Ç—å –Ω–æ—É—Ç–±—É–∫–∞, –∞–ª–µ –º–∞—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è 600 —Ä—è–¥–∫—ñ–≤.
2.  **Conversion:** –ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–π —Ä—è–¥–æ–∫ `df_h2o[target].asfactor()` ‚Äî –±–µ–∑ –Ω—å–æ–≥–æ H2O –º–æ–∂–µ –ø–æ–¥—É–º–∞—Ç–∏, —â–æ —Ü–µ –∑–∞–¥–∞—á–∞ —Ä–µ–≥—Ä–µ—Å—ñ—ó (—è–∫—â–æ –¥—ñ–∞–≥–Ω–æ–∑ 0/1), —ñ –º–µ—Ç—Ä–∏–∫–∏ —Ç–∏–ø—É AUC/Confusion Matrix –±—É–¥—É—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ.
3.  **Artifacts:** –ú–∏ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–µ —Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏, –∞ –π –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–º–∞—Ç—Ä–∏—Ü—é, ROC –∫—Ä–∏–≤—É) —Ç–∞ CSV –∑ –ª—ñ–¥–µ—Ä–±–æ—Ä–¥–æ–º, —â–æ–± –≤–∏–∫–ª–∞–¥–∞—á—É –±—É–ª–æ –∑—Ä—É—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ä–æ–±–æ—Ç—É —á–µ—Ä–µ–∑ MLflow UI.




–ó–∞–ø–∏—Ç:
–ó–≥–µ–Ω–µ—Ä—É–π —á–µ–∫-–ª—ñ—Å—Ç –¥–ª—è README:
¬† —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π,
¬† —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É `data/raw/`,
¬† –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è baseline —Ç–∞ AutoML,
¬† —è–∫ –≤—ñ–¥–∫—Ä–∏—Ç–∏ `MLflow UI`,
¬† —â–æ –ø—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ –≤ `reports/` (—Ç–∞–±–ª–∏—Ü—è –º–µ—Ç—Ä–∏–∫, —Å–∫—Ä—ñ–Ω –ª—ñ–¥–µ—Ä–±–æ—Ä–¥–∞, –º–∞—Ç—Ä–∏—Ü—è –∑–º—ñ—à—É–≤–∞–Ω–Ω—è, ROC/PR).
–§–æ—Ä–º–∞—Ç:
¬† 1) —Å–µ–∫—Ü—ñ—ó README –∑ –ø—É–Ω–∫—Ç–∞–º–∏;
¬† 2) –ø—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–º–∞–Ω–¥;
¬† 3) —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `reports/`.

¬† 
–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–û—Å—å –≥–æ—Ç–æ–≤–∏–π —à–∞–±–ª–æ–Ω –≤–º—ñ—Å—Ç—É –¥–ª—è –≤–∞—à–æ–≥–æ `README.md`, –∞ —Ç–∞–∫–æ–∂ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–≤—ñ—Ç–Ω–æ—Å—Ç—ñ. –¶–µ–π —á–µ–∫-–ª—ñ—Å—Ç —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π —Ç–∞–∫, —â–æ–± –±—É–¥—å-—Ö—Ç–æ (–∞–±–æ –≤–∏ —Å–∞–º—ñ —á–µ—Ä–µ–∑ –º—ñ—Å—è—Ü—å) –∑–º—ñ–≥ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.

### 1\. –°–µ–∫—Ü—ñ—ó README.md

–°–∫–æ–ø—ñ—é–π—Ç–µ —Ü–µ–π —Ç–µ–∫—Å—Ç —É —Ñ–∞–π–ª `README.md` —É –∫–æ—Ä–µ–Ω—ñ –≤–∞—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É.

````markdown
# H2O AutoML Diagnosis Classification

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –º–µ–¥–∏—á–Ω–∏—Ö –¥—ñ–∞–≥–Ω–æ–∑—ñ–≤ (–±—ñ–Ω–∞—Ä–Ω–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º H2O AutoML —Ç–∞ —Ç—Ä–µ–∫—ñ–Ω–≥–æ–º –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ —É MLflow.

## üìã 1. –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –≤–∏–º–æ–≥–∏ (Prerequisites)
- **OS:** Linux
- **Python:** 3.12+
- **Java:** JDK (–Ω–µ–æ–±—Ö—ñ–¥–Ω–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ H2O)
  - –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ Ubuntu/Debian: `sudo apt install default-jdk`

## ‚öôÔ∏è 2. –Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ—è

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ:**
   ```bash
   python3.12 -m venv venv
   source venv/bin/activate
````

2.  **–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:**
    ```bash
    pip install -r requirements.txt
    ```

## üìÇ 3. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

1.  –†–æ–∑–º—ñ—Å—Ç—ñ—Ç—å –≤–∞—à –≤–∏—Ö—ñ–¥–Ω–∏–π CSV-—Ñ–∞–π–ª —É –ø–∞–ø–∫—É:
    `data/raw/`

2.  –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `configs/config.yaml`:

      - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `raw_path` –≤–∫–∞–∑—É—î –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–µ —ñ–º'—è —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `../data/raw/my_dataset.csv`).
      - –í–∫–∞–∂—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É –Ω–∞–∑–≤—É —Ü—ñ–ª—å–æ–≤–æ—ó –∫–æ–ª–æ–Ω–∫–∏ —É `target_col`.

## üöÄ 4. –ó–∞–ø—É—Å–∫ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤

### –ï—Ç–∞–ø 1: Baseline (–õ–æ–≥—ñ—Å—Ç–∏—á–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è)

–ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Å—Ç—É –º–æ–¥–µ–ª—å –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è –º–µ—Ç—Ä–∏–∫.

```bash
# –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
python src/train.py

# –û—Ü—ñ–Ω–∫–∞ —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤ MLflow
python src/evaluate.py
```

### –ï—Ç–∞–ø 2: H2O AutoML

–ó–∞–ø—É—Å–∫–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–æ—à—É–∫ –Ω–∞–π–∫—Ä–∞—â–æ—ó –º–æ–¥–µ–ª—ñ (–æ–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É: 15 —Ö–≤).

```bash
python src/automl_run.py
```

## üìä 5. –ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (MLflow UI)

–©–æ–± –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –º–æ–¥–µ–ª—ñ —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫–∏:

1.  –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä MLflow:
    ```bash
    mlflow ui --backend-store-uri mlruns
    ```
2.  –í—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ: [http://127.0.0.1:5000](https://www.google.com/search?q=http://127.0.0.1:5000)

-----

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–≤—ñ—Ç—É (Reports)

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –ø–∞–ø—Ü—ñ `reports/`.

````

---

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ `reports/`

–°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É `reports/` —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É. –¶–µ —Ç–µ, —â–æ –≤–∏ –∑–¥–∞—î—Ç–µ –≤–∏–∫–ª–∞–¥–∞—á—É –∞–±–æ –ø–æ–∫–∞–∑—É—î—Ç–µ —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–∞–º.

**–î–µ—Ä–µ–≤–æ —Ñ–∞–π–ª—ñ–≤:**

```text
reports/
‚îú‚îÄ‚îÄ README_RESULTS.md        # –ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å, —è–∫–∞ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–º–æ–≥–ª–∞ —ñ —á–æ–º—É
‚îú‚îÄ‚îÄ comparison_table.csv     # –¢–∞–±–ª–∏—Ü—è: Baseline vs H2O Leader (Metric: AUC, Recall, F1)
‚îú‚îÄ‚îÄ figures/
‚îÇ   ‚îú‚îÄ‚îÄ baseline_confusion_matrix.png
‚îÇ   ‚îú‚îÄ‚îÄ h2o_confusion_matrix.png
‚îÇ   ‚îú‚îÄ‚îÄ h2o_roc_curve.png
‚îÇ   ‚îî‚îÄ‚îÄ h2o_variable_importance.png  # (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, —è–∫—â–æ H2O —Ü–µ –∑–≥–µ–Ω–µ—Ä—É—î)
‚îî‚îÄ‚îÄ screenshots/
    ‚îú‚îÄ‚îÄ mlflow_dashboard.png         # –°–∫—Ä—ñ–Ω –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É —Ä–∞–Ω—ñ–≤
    ‚îî‚îÄ‚îÄ h2o_leaderboard.png          # –°–∫—Ä—ñ–Ω —Ç–æ–ø-5 –º–æ–¥–µ–ª–µ–π –∑—ñ —Å–ø–∏—Å–∫—É
````

### 3\. –©–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø–æ–∫–ª–∞—Å—Ç–∏ –≤ –∑–≤—ñ—Ç (–ß–µ–∫-–ª—ñ—Å—Ç –≤–º—ñ—Å—Ç—É)

1.  **–¢–∞–±–ª–∏—Ü—è –º–µ—Ç—Ä–∏–∫ (comparison\_table.csv):**
    –ó–≤–µ–¥—ñ—Ç—å –∫–ª—é—á–æ–≤—ñ —Ü–∏—Ñ—Ä–∏ –≤ –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—é.
    *–ü—Ä–∏–∫–ª–∞–¥:*
    | Model | Accuracy | Recall (Sensitivity) | Precision | F1 (Macro) | AUC-ROC |
    |-------|----------|----------------------|-----------|------------|---------|
    | Baseline (LogReg) | 0.72 | 0.65 | 0.68 | 0.66 | - |
    | H2O Leader (GBM) | **0.85** | **0.82** | **0.80** | **0.81** | **0.91** |

2.  **–°–∫—Ä—ñ–Ω –õ—ñ–¥–µ—Ä–±–æ—Ä–¥–∞ (h2o\_leaderboard.png):**
    –ó—Ä–æ–±—ñ—Ç—å —Å–∫—Ä—ñ–Ω—à–æ—Ç –≤–∏–≤–æ–¥—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—É –∞–±–æ HTML-—Ç–∞–±–ª–∏—Ü—ñ –∑ MLflow, –¥–µ –≤–∏–¥–Ω–æ —Ç–æ–ø-5 –º–æ–¥–µ–ª–µ–π H2O. –¶–µ –¥–æ–≤–æ–¥–∏—Ç—å, —â–æ AutoML —Å–ø—Ä–∞–≤–¥—ñ –ø–µ—Ä–µ–±—Ä–∞–≤ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ (GBM, DRF, GLM —Ç–æ—â–æ).

3.  **–ú–∞—Ç—Ä–∏—Ü—è –∑–º—ñ—à—É–≤–∞–Ω–Ω—è (Confusion Matrix):**
    –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –≥—Ä–∞—Ñ—ñ–∫ –¥–ª—è –º–µ–¥–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

      * *–©–æ –∫–æ–º–µ–Ω—Ç—É–≤–∞—Ç–∏:* "–ú–æ–¥–µ–ª—å H2O –¥–æ–ø—É—Å—Ç–∏–ª–∞ –ª–∏—à–µ 5 –ø–æ–º–∏–ª–æ–∫ False Negative (–ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ —Ö–≤–æ—Ä–∏—Ö), —Ç–æ–¥—ñ —è–∫ Baseline –¥–æ–ø—É—Å—Ç–∏–ª–∞ 12. –¶–µ –∫—Ä–∏—Ç–∏—á–Ω–µ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è."

4.  **ROC-–∫—Ä–∏–≤–∞:**
    –í—ñ–∑—É–∞–ª—å–Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –∫–ª–∞—Å—ñ–≤. –ß–∏–º –±–ª–∏–∂—á–µ –∫—Ä–∏–≤–∞ –¥–æ –ª—ñ–≤–æ–≥–æ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ –∫—É—Ç–∞, —Ç–∏–º –∫—Ä–∞—â–µ.

-----

### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫

–ë–∞–∂–∞—î—Ç–µ, —è –Ω–∞–ø–∏—à—É **–∫–æ—Ä–æ—Ç–∫–∏–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python**, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—Ç—è–≥–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ `mlruns`, –∑–≥–µ–Ω–µ—Ä—É—î `comparison_table.csv` —ñ –∑–±–µ—Ä–µ–∂–µ –π–æ–≥–æ –≤ –ø–∞–ø–∫—É `reports/`, —â–æ–± –Ω–µ —Ä–æ–±–∏—Ç–∏ —Ü–µ –≤—Ä—É—á–Ω—É?


–ó–∞–ø–∏—Ç:
Baseline –¥–æ—Å—è–≥ f1 = 0.972 –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ
–ó–∞–ø—Ä–æ–ø–æ–Ω—É–π –Ω–µ–≤–µ–ª–∏–∫—É –∑–º—ñ–Ω—É –¥–æ baseline –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è f1 –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ.
–§–æ—Ä–º–∞—Ç:
1) –∑–º—ñ–Ω–∏ –¥–æ train.
2) –∑–º—ñ–Ω–∏ –¥–æ test (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ).
3) –∫–æ—Ä–æ—Ç–∫–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–û—Å–∫—ñ–ª—å–∫–∏ F1 = 0.972 ‚Äî —Ü–µ –≤–∂–µ –¥—É–∂–µ –≤–∏—Å–æ–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø—Ä–æ—Å—Ç–µ "–≤–≥–∞–¥—É–≤–∞–Ω–Ω—è" –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –Ω–∞–≤—Ä—è–¥ —á–∏ –¥–æ–ø–æ–º–æ–∂–µ. –ù–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –≤–∏—Ç–∏—Å–Ω—É—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ —á–∞—Å—Ç–∫–∏ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –±–µ–∑ –∑–º—ñ–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É ‚Äî —Ü–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø—ñ–¥–±—ñ—Ä –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (Grid Search)**, –∑–æ–∫—Ä–µ–º–∞ —Å–∏–ª–∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó (`C`) —Ç–∞ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –≤–∞–≥ –∫–ª–∞—Å—ñ–≤.

–ú–∏ –∑–º—ñ–Ω–∏–º–æ –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–¥–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –ø–æ—à—É–∫ –Ω–∞–π–∫—Ä–∞—â–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó.

### 1\. –ó–º—ñ–Ω–∏ –¥–æ `src/train.py`

–ó–∞–º—ñ–Ω—ñ—Ç—å –±–ª–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –Ω–∞ —Ü–µ–π –∫–æ–¥. –ú–∏ –¥–æ–¥–∞—î–º–æ `GridSearchCV` –¥–ª—è –ø–æ—à—É–∫—É –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ `C` —Ç–∞ –≤–º–∏–∫–∞—î–º–æ `class_weight`.

```python
# ... (—ñ–º–ø–æ—Ä—Ç–∏ —Ç—ñ —Å–∞–º—ñ, –¥–æ–¥–∞—î–º–æ GridSearchCV)
from sklearn.model_selection import GridSearchCV

# ... (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ —Å–ø–ª—ñ—Ç –¥–∞–Ω–∏—Ö —Ç—ñ —Å–∞–º—ñ)

# 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–π–ø–ª–∞–π–Ω—É —Ç–∞ —Å—ñ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
pipeline = make_pipeline(
    StandardScaler(),
    LogisticRegression(
        solver='liblinear', # liblinear –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î –Ω–∞ –º–∞–ª–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö
        random_state=config['project']['random_state'],
        max_iter=2000
    )
)

# –°—ñ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É
# logisticregression__C: –∫–µ—Ä—É—î —Å–∏–ª–æ—é —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó (–º–µ–Ω—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è = —Å–∏–ª—å–Ω—ñ—à–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è)
# class_weight: 'balanced' –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–Ω—ñ–º–µ –≤–∞–≥—É –º–µ–Ω—à–æ–≥–æ –∫–ª–∞—Å—É, —â–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è F1
param_grid = {
    'logisticregression__C': [0.1, 1.0, 5.0, 10.0, 50.0],
    'logisticregression__penalty': ['l1', 'l2'], # –°–ø—Ä–æ–±—É—î–º–æ L1 (Lasso) —Ç–∞ L2 (Ridge)
    'logisticregression__class_weight': [None, 'balanced']
}

# 5. –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∑ –∫—Ä–æ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é
print("Tuning hyperparameters with GridSearchCV...")
grid_search = GridSearchCV(
    pipeline, 
    param_grid, 
    cv=5, 
    scoring='f1_macro', # –Ø–≤–Ω–æ –æ–ø—Ç–∏–º—ñ–∑—É—î–º–æ —Ç—É –º–µ—Ç—Ä–∏–∫—É, —è–∫–∞ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∞
    n_jobs=-1,
    verbose=1
)

grid_search.fit(X_train, y_train)

print(f"Best parameters found: {grid_search.best_params_}")
print(f"Best CV F1 Score: {grid_search.best_score_:.4f}")

# 6. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–æ—ó –º–æ–¥–µ–ª—ñ
# –ú–∏ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ best_estimator_, —â–æ–± evaluate.py –ø—Ä–∞—Ü—é–≤–∞–≤ –±–µ–∑ –∑–º—ñ–Ω
best_model = grid_search.best_estimator_

os.makedirs(os.path.dirname(config['paths']['model_output']), exist_ok=True)
with open(config['paths']['model_output'], 'wb') as f:
    pickle.dump(best_model, f)

# ... (–∫–æ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è test_data –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω)
```

### 2\. –ó–º—ñ–Ω–∏ –¥–æ `src/evaluate.py`

**–ó–º—ñ–Ω –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î.**
–û—Å–∫—ñ–ª—å–∫–∏ –≤ `train.py` –º–∏ –∑–±–µ—Ä–µ–≥–ª–∏ `grid_search.best_estimator_` (–≤–∂–µ —Ç—Ä–µ–Ω–æ–≤–∞–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω —ñ–∑ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏), —Å–∫—Ä–∏–ø—Ç –æ—Ü—ñ–Ω–∫–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å —Ü—é "–ø–æ–∫—Ä–∞—â–µ–Ω—É" –≤–µ—Ä—Å—ñ—é —ñ –ø–æ—Ä–∞—Ö—É—î –º–µ—Ç—Ä–∏–∫–∏ —è–∫ –∑–∞–∑–≤–∏—á–∞–π.

### 3\. –ü–æ—è—Å–Ω–µ–Ω–Ω—è –∑–º—ñ–Ω

1.  **–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è (`C` —Ç–∞ `penalty`):** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ `C=1.0` –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–º. –Ø–∫—â–æ –¥–∞–Ω—ñ –¥—É–∂–µ –¥–æ–±—Ä–µ —Ä–æ–∑–¥—ñ–ª—è—é—Ç—å—Å—è (F1 \~0.97), –º–æ–¥–µ–ª—å –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä–æ—Ö–∏ –ø–µ—Ä–µ–Ω–∞–≤—á–µ–Ω–∞ ("overconfident"). –ó–º—ñ–Ω–∞ `C` –∞–±–æ —Ç–∏–ø—É —à—Ç—Ä–∞—Ñ—É (`l1` vs `l2`) –º–æ–∂–µ –∑–≥–ª–∞–¥–∏—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ñ —Ä—ñ—à–µ–Ω—å —ñ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç—ñ.
2.  **`class_weight='balanced'`:** –¶–µ –∫–ª—é—á–æ–≤–∞ –∑–º—ñ–Ω–∞ –¥–ª—è –º–µ—Ç—Ä–∏–∫–∏ F1 –ø—Ä–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å—ñ. –¶–µ –∑–º—É—à—É—î –º–æ–¥–µ–ª—å —Å–∏–ª—å–Ω—ñ—à–µ —à—Ç—Ä–∞—Ñ—É–≤–∞—Ç–∏ –∑–∞ –ø–æ–º–∏–ª–∫–∏ –Ω–∞ –º–µ–Ω—à–æ–º—É –∫–ª–∞—Å—ñ ("—Ö–≤–æ—Ä–∏—Ö"), —â–æ –∑–∞–∑–≤–∏—á–∞–π –ø—ñ–¥–Ω—ñ–º–∞—î **Recall**, –∞ –æ—Ç–∂–µ —ñ **F1-Macro**.
3.  **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ü—ñ–ª—ñ (`scoring='f1_macro'`):** –†–∞–Ω—ñ—à–µ LogReg –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞–ª–∞ *LogLoss/Accuracy*. –¢–µ–ø–µ—Ä GridSearch –≤–∏–±–µ—Ä–µ —Å–∞–º–µ —Ç—É –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —è–∫–∞ –¥–∞—î –Ω–∞–π–≤–∏—â–∏–π *F1*, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ Accuracy –ø—Ä–∏ —Ü—å–æ–º—É —Ç—Ä–æ—Ö–∏ –≤–ø–∞–¥–µ.

–ó–∞–ø–∏—Ç:
–¥–æ—Å—è–≥–Ω–µ–Ω–æ f1 = 0.981 –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ.
Best parameters found: {'logisticregression__C': 0.1, 'logisticregression__class_weight': None, 'logisticregression__penalty': 'l2'}
–ó–∞–ø—Ä–æ–ø–æ–Ω—É–π –Ω–æ–≤—ñ –ø–∞—Ä–º–µ—Ç—Ä–∏ –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É —É GridSearchCV.
–§–æ—Ä–º–∞—Ç:¬†
¬†1) –∑–º—ñ–Ω–∏ –¥–æ train.¬†
¬†3) –∫–æ—Ä–æ—Ç–∫–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
–¶–µ —á—É–¥–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç\! F1 = 0.981 –¥–ª—è baseline ‚Äî —Ü–µ –¥—É–∂–µ —Å–∏–ª—å–Ω–æ.

–¢–æ–π —Ñ–∞–∫—Ç, —â–æ –Ω–∞–π–∫—Ä–∞—â–∏–º –≤–∏—è–≤–∏–≤—Å—è `C: 0.1` (–Ω–∞–π–º–µ–Ω—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Å–ø–∏—Å–∫—É), —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ **–æ–ø—Ç–∏–º—É–º –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ª—ñ–≤—ñ—à–µ** (—É –±—ñ–∫ —Å–∏–ª—å–Ω—ñ—à–æ—ó —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó). –ú–∏ "–≤–ø–µ—Ä–ª–∏—Å—è" –≤ –∫—Ä–∞–π –¥—ñ–∞–ø–∞–∑–æ–Ω—É.

–û—Å—å —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è "Fine-Tuning": –º–∏ –∑–º–µ–Ω—à–∏–º–æ –∫—Ä–æ–∫ –ø–æ—à—É–∫—É —ñ –¥–æ—Å–ª—ñ–¥–∏–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –Ω–∞–≤–∫–æ–ª–æ 0.1 —Ç–∞ –Ω–∏–∂—á–µ.

### 1\. –ó–º—ñ–Ω–∏ –¥–æ `src/train.py`

–ó–º—ñ–Ω—ñ—Ç—å —Å–ª–æ–≤–Ω–∏–∫ `param_grid` –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π. –ú–∏ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –≤–µ–ª–∏–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è `C` —ñ –¥–æ–¥–∞—î–º–æ –¥—Ä—ñ–±–Ω—ñ—à—ñ, –∞ —Ç–∞–∫–æ–∂ —Ñ–æ–∫—É—Å—É—î–º–æ—Å—å –Ω–∞ `l2`, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –ø–µ—Ä–µ–º–æ–≥–ª–∞ (–∞–ª–µ –ª–∏—à–∞—î–º–æ `l1` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ –º–∞–ª–∏—Ö `C`).

```python
# ... (—ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –±–µ–∑ –∑–º—ñ–Ω) ...

# 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–π–ø–ª–∞–π–Ω—É (Solver liblinear –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—î –∑ l1/l2 —ñ –º–∞–ª–∏–º–∏ –¥–∞–Ω–∏–º–∏)
pipeline = make_pipeline(
    StandardScaler(),
    LogisticRegression(
        solver='liblinear', 
        random_state=config['project']['random_state'],
        max_iter=3000 # –ó–±—ñ–ª—å—à–∏–º–æ —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –¥–ª—è –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ —É –∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –ø—Ä–∏ –º–∞–ª–∏—Ö C
    )
)

# –ó–º—ñ–Ω–µ–Ω–∏–π Grid: "Zoom-in" –Ω–∞–≤–∫–æ–ª–æ 0.1
param_grid = {
    # –î–æ—Å–ª—ñ–¥–∂—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –º–µ–Ω—à–µ 0.1, —Ç–∞ —Ä–æ–±–∏–º–æ –º–µ–Ω—à–∏–π –∫—Ä–æ–∫ –Ω–∞–≤–∫–æ–ª–æ 0.1
    'logisticregression__C': [0.01, 0.03, 0.05, 0.08, 0.1, 0.12, 0.15, 0.2, 0.5],
    
    # –û—Å–∫—ñ–ª—å–∫–∏ 'None' –ø–µ—Ä–µ–º—ñ–≥ 'balanced', –∑–∞–ª–∏—à–∞—î–º–æ –ª–∏—à–µ None, —â–æ–± –Ω–µ –≤–∏—Ç—Ä–∞—á–∞—Ç–∏ —á–∞—Å,
    # –∞–±–æ –¥–æ–¥–∞—î–º–æ —Å–ª–æ–≤–Ω–∏–∫ –≤–∞–≥ –≤—Ä—É—á–Ω—É, —è–∫—â–æ —Ö–æ—á–µ–º–æ —Ç–æ–Ω–∫–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, {0:1, 1:1.2})
    'logisticregression__class_weight': [None], 
    
    # –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ L2 (–ø–µ—Ä–µ–º–æ–∂–µ—Ü—å) —Ç–∞ L1 (–º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∞—â–∏–º –ø—Ä–∏ –¥—É–∂–µ —Å–∏–ª—å–Ω–æ–º—É C < 0.05)
    'logisticregression__penalty': ['l2', 'l1']
}

# ... (–∫–æ–¥ –∑–∞–ø—É—Å–∫—É GridSearchCV –±–µ–∑ –∑–º—ñ–Ω) ...
```

### 3\. –ö–æ—Ä–æ—Ç–∫–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è

1.  **–ó—Å—É–≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—É `C`:** –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –Ω–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (`0.1`) –±—É–≤ –Ω–∞ –º–µ–∂—ñ –ø–æ—à—É–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É. –¶–µ –∫–ª–∞—Å–∏—á–Ω–∏–π —Å–∏–≥–Ω–∞–ª –≤ ML: "–∫–æ–ø–∞–π –¥–∞–ª—ñ –≤ —Ü—å–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É". –ú–∏ –¥–æ–¥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è `0.01`, `0.03`, `0.05`, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –Ω–µ –¥–æ–ø–æ–º–æ–∂–µ —â–µ —Å–∏–ª—å–Ω—ñ—à–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è –ø—Ä–∏–±—Ä–∞—Ç–∏ —à—É–º.
2.  **–¢–æ—á–Ω—ñ—Å—Ç—å –∫—Ä–æ–∫—É:** –ó–∞–º—ñ—Å—Ç—å —Å—Ç—Ä–∏–±–∫—ñ–≤ `x10` (0.1 -\> 1.0), –º–∏ —Ä–æ–±–∏–º–æ –º–∞–ª—ñ –∫—Ä–æ–∫–∏ (`0.08`, `0.12`), —â–æ–± –∑–Ω–∞–π—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –º–∞–∫—Å–∏–º—É–º.
3.  **–í–∏–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–π–≤–æ–≥–æ:** –û—Å–∫—ñ–ª—å–∫–∏ `class_weight: None` –≤–ø–µ–≤–Ω–µ–Ω–æ –ø–µ—Ä–µ–º—ñ–≥, –º–∏ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ `balanced` –∑ –ø–µ—Ä–µ–±–æ—Ä—É, —â–æ–± –∑–µ–∫–æ–Ω–æ–º–∏—Ç–∏ —á–∞—Å –æ–±—á–∏—Å–ª–µ–Ω—å —ñ –∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—å –Ω–∞ –ø—ñ–¥–±–æ—Ä—ñ `C`.
